/* project-viewer.min.js | Created on 17/02/2016 */
angular.module("pvApp.services",[]),angular.module("pvApp.controllers",[]),angular.module("pvApp.directives",[]),angular.module("pvApp.filters",[]),angular.module("pvApp.providers",[]),angular.module("pvApp",["ui.router","ui.router.stateHelper","pvApp.services","pvApp.controllers","pvApp.directives","pvApp.filters","pvApp.providers","pvApp.sqlTool","pvApp.d3charts"]).config(["$urlRouterProvider","$stateProvider","$locationProvider","stateHelperProvider",function(a,b,c,d){d.createStates([{name:"home",url:"/home",templateUrl:"subprojects/pages/base/landing.html",controller:"homeController"},{name:"sqltool",url:"/sqltool",templateUrl:"subprojects/pages/sqlTool/landing.html",controller:"sqlToolController"},{name:"d3charts",url:"/d3charts",templateUrl:"subprojects/pages/d3charts/landing.html",controller:"d3chartsController"}])}]).run(["$rootScope","$state","$stateParams","$templateCache",function(a,b,c,d){a.$state=b,a.$stateParams=c}]),angular.module("pvApp.d3charts.controllers",[]),angular.module("pvApp.d3charts.services",[]),angular.module("pvApp.d3charts.directives",[]),angular.module("pvApp.d3charts",["pvApp.d3charts.controllers","pvApp.d3charts.services","pvApp.d3charts.directives"]).config(["$urlRouterProvider","$stateProvider","$locationProvider","stateHelperProvider",function(a,b,c,d){d.createStates([{name:"d3charts.graphchart",url:"/graphchart",templateUrl:"subprojects/pages/d3charts/graph-chart-landing.html",controller:"graphChartController"},{name:"d3charts.forcechart",url:"/forcechart",templateUrl:"subprojects/pages/d3charts/force-chart-landing.html",controller:"forceChartController"}])}]).run(["$rootScope","$state","$stateParams","$templateCache",function(a,b,c,d){a.$state=b,a.$stateParams=c}]),angular.module("pvApp.sqlTool.controllers",[]),angular.module("pvApp.sqlTool.services",[]),angular.module("pvApp.sqlTool.directives",[]),angular.module("pvApp.sqlTool",["pvApp.sqlTool.controllers","pvApp.sqlTool.services","pvApp.sqlTool.directives"]).config(["$urlRouterProvider","$stateProvider","$locationProvider","stateHelperProvider",function(a,b,c,d){d.createStates([{name:"sqltool.tables",url:"/tables?dbid&tableid",templateUrl:"subprojects/pages/sqlTool/tables.html",controller:"tablesController"},{name:"sqltool.state2",url:"/state2",templateUrl:"subprojects/pages/sqlTool/state2.html"}])}]).run(["$rootScope","$state","$stateParams","$templateCache",function(a,b,c,d){a.$state=b,a.$stateParams=c}]),angular.module("pvApp.controllers").controller("appController",["$rootScope","$scope",function(a,b){}]),angular.module("pvApp.controllers").controller("homeController",["$scope",function(a){}]),angular.module("pvApp.d3charts.controllers").controller("d3chartsController",["$scope","$templateCache",function(a,b){}]),angular.module("pvApp.d3charts.controllers").controller("forceChartController",["$scope","$timeout","d3chartsService",function(a,b,c){function d(a,b){var c={};return c.nodes=a.nodes.slice(0,b),c.links=a.links.slice(0,b),c}c.getForceGraphData().then(function(b){a.forceGraphData=d(b.data,20)}),a.nodesToAdd=10,a.addNodes=function(){var d=10,e=setInterval(function(){c.getLexData(parseInt(a.nodesToAdd),function(b){a.nodesLoadProgress=b}).then(function(c){b(function(){a.$emit("onNodesAdd",c.data)}),d--,0>=d&&(clearInterval(e),e=null)})},10)}}]),angular.module("pvApp.d3charts.controllers").controller("graphChartController",["$scope","d3graphService","d3graphFactory","d3LexService",function(a,b,c,d){a.currentNode=void 0,a.queryParams="",b.getGraphCategories().then(function(b){a.graphCategories=b.data}),a.getCategoryColorCode=function(a){function b(a){var b=(16777215&a).toString(16).toUpperCase();return"00000".substring(0,6-b.length)+b}return"#"+b(234435*a.id)},a.selectCategory=function(b,c){a.currentCategory=c},a.getCategoryByName=function(b){var c=a.graphCategories.filter(function(a,c){return a.label===b});return void 0!==c&&c.length?c[0]:void 0},a.moveCategoryToTop=function(b,c){a.currentCategory=c;var d=b.indexOf(c);0>=d||(b.splice(d,1),b.splice(0,0,c))},a.$watch("currentCategory",function(c,e){void 0!==c&&null!==c&&b.getNodesByCategory(c).then(function(b){d.parseRawToGraph(b,!0).then(function(b){a.graphData=b,a.$emit("onGraphUpdate",b)})})}),a.$watch("currentNode",function(c){void 0!==c&&null!==c&&b.lexNodesAndEdgesByNodeId(c.id).then(function(b){if(b&&b.data&&b.data.result&&b.data.result.data){var c=b.data.result.data;d.parseRawToGraph(c).then(function(b){a.graphData=b,a.$emit("onGraphUpdate",b)})}})}),a.runQuery=function(c){void 0!==a.queryParams&&""!==a.queryParams.trim()&&b.lexRunQuery(a.queryParams).then(function(b){b&&b.data&&b.data.result&&b.data.result.data&&d.parseRawToGraph(b.data.result.data).then(function(b){a.graphData=b,a.$emit("onGraphUpdate",b)})})}}]),angular.module("pvApp.d3charts.directives").directive("forceChart",[function(){function a(a){c=d3.layout.force().charge(-1e3).gravity(.05).linkDistance(150).size([a.width,a.height]),d=d3.scale.category20()}function b(a,b,e,f,g){f===!0&&a.selectAll("*").remove();var h=c.nodes()||[],i=c.links()||[];b.nodes=h.concat(b.nodes),b.links=i.concat(b.links),c.nodes(b.nodes).links(b.links),g===!0?c.start():c.resume();var j=a.selectAll(".link").data(b.links).enter().append("line").attr("class","link").style("stroke-width",1).attr("marker-end",function(a){return"url(#suit)"}),k=a.selectAll(".node").data(b.nodes).enter().append("circle").attr("class","node").attr("r",e.radius).style("fill",function(a){return d(a.group?a.group:a.category&&a.category.id?50*a.category.id:100)}).call(c.drag),l=a.selectAll(".node-text").data(b.nodes).enter().append("text").attr("class","node-text").attr("x",-e.radius/2).attr("y",0).text(function(a){return a.label});a.selectAll("marker").data(["suit","licensing","resolved"]).enter().append("marker").attr("id",function(a){return a}).attr("viewBox","-"+e.arrowSize+" -"+e.arrowSize+" "+2*e.arrowSize+" "+2*e.arrowSize).attr("refX",e.arrowSize+e.radius).attr("refY",0).attr("markerWidth",2*e.arrowSize).attr("markerHeight",2*e.arrowSize).attr("orient","auto").append("path").attr("d","M-"+e.arrowSize+",-"+e.arrowSize+" L "+e.arrowSize+",0 L -"+e.arrowSize+","+e.arrowSize+" Z");c.on("tick",function(){j.attr("x1",function(a){return a.source.x}).attr("y1",function(a){return a.source.y}).attr("x2",function(a){return a.target.x}).attr("y2",function(a){return a.target.y}),k.attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y}),l.attr("transform",function(a){return"translate("+a.x+","+a.y+")"})})}var c,d;return{restrict:"AE",templateUrl:"subprojects/pages/d3charts/force-chart.html",link:function(c,d,e,f){var g={margin:parseInt(e.margin)||20,barHeight:parseInt(e.barHeight)||100,barPadding:parseInt(e.barPadding)||5,nodeSize:parseInt(e.nodeSize)||150,width:parseInt(e.width)||1400,height:parseInt(e.height)||550,radius:parseInt(e.radius)||50,arrowSize:parseInt(e.arrowSize)||10},h=($(d),d3.select(d[0]).select(".chart-container").append("svg").attr("width",g.width).attr("height",g.height));a(g),c.$watch("forceGraphData",function(a){a&&b(h,a,g,!0,!0)}),c.$on("onNodesAdd",function(a,c){c&&b(h,c,g,!1,!0)})}}}]),angular.module("pvApp.d3charts.directives").directive("graphChart",[function(){function a(a){c=d3.layout.force().charge(-1e3).gravity(.15).linkDistance(200).size([a.width,a.height]),d=d3.scale.category20()}function b(a,b,d,e,f,g){function h(a){d3.select(this).classed("fixed",a.fixed=!0)}function i(a){o.hide(a),e.currentNode=a,e.$apply()}function j(a){o.show(a)}function k(a){o.hide(a)}f===!0&&a.selectAll("*").remove(),c.nodes(b.nodes).links(b.edges),g===!0?c.start():c.resume();var l=a.selectAll(".link").data(b.edges).enter().append("line").attr("class","link").style("stroke-width",1).attr("marker-end",function(a){return"url(#suit)"}),m=a.selectAll(".node").data(b.nodes).enter().append("circle").attr("class","node").attr("r",d.radius).style("fill",function(a){return e.getCategoryColorCode(e.getCategoryByName(a.label))}).on("dblclick",i).on("mouseover",j).on("mouseout",k).call(c.drag),n=a.selectAll(".node-text").data(b.nodes).enter().append("text").attr("class","node-text").attr("x",-d.radius/2).attr("y",0).text(function(a){return a.properties.person_name}),o=(a.selectAll("marker").data(["suit","licensing","resolved"]).enter().append("marker").attr("id",function(a){return a}).attr("viewBox","-"+d.arrowSize+" -"+d.arrowSize+" "+2*d.arrowSize+" "+2*d.arrowSize).attr("refX",d.arrowSize+d.radius).attr("refY",0).attr("markerWidth",2*d.arrowSize).attr("markerHeight",2*d.arrowSize).attr("orient","auto").append("path").attr("d","M-"+d.arrowSize+",-"+d.arrowSize+" L "+d.arrowSize+",0 L -"+d.arrowSize+","+d.arrowSize+" Z"),d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(a){var b=a.properties&&a.properties.person_emailId&&a.properties.person_emailId.length&&a.properties.person_emailId[0].value,c=["<h3>Node Information</h3>",'<div class="category">CATEGORY: '+a.label+"</div>",'<div class="email">EMAIL: '+b+"</div>","<div>All other information....</div>"].join("");return c}));a.call(o),c.on("tick",function(){l.attr("x1",function(a){return a.source.x}).attr("y1",function(a){return a.source.y}).attr("x2",function(a){return a.target.x}).attr("y2",function(a){return a.target.y}),m.attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y}),n.attr("transform",function(a){return"translate("+a.x+","+a.y+")"})});c.drag().on("dragstart",h)}var c,d;return{restrict:"AE",templateUrl:"subprojects/pages/d3charts/graph-chart.html",link:function(c,d,e,f){var g={margin:parseInt(e.margin)||20,barHeight:parseInt(e.barHeight)||100,barPadding:parseInt(e.barPadding)||5,nodeSize:parseInt(e.nodeSize)||150,width:parseInt(e.width)||1400,height:parseInt(e.height)||550,radius:parseInt(e.radius)||40,arrowSize:parseInt(e.arrowSize)||5},h=($(d),d3.select(d[0]).select(".chart-container").append("svg").attr("width",g.width).attr("height",g.height));a(g),c.$on("onGraphUpdate",function(a,d){d&&b(h,d,g,c,!0,!0)}),c.$on("onNodesAdd",function(a,d){d&&b(h,d,g,c,!1,!0)})}}}]),angular.module("pvApp.d3charts.directives").directive("sampleChart1",[function(){function a(a,b,c){if(a.selectAll("*").remove(),b){var d=a.node().offsetWidth-c.margin,e=b.length*(c.barHeight+c.barPadding),f=d3.scale.category20(),g=d3.scale.linear().domain([0,d3.max(b,function(a){return a.score})]).range([0,d]);a.attr("height",e),a.selectAll("rect").data(b).enter().append("rect").attr("height",c.barHeight).attr("width",140).attr("x",Math.round(c.margin/2)).attr("y",function(a,b){return b*(c.barHeight+c.barPadding)}).attr("fill",function(a){return f(a.score)}).transition().duration(1e3).attr("width",function(a){return g(a.score)})}}return{restrict:"AE",templateUrl:"subprojects/pages/d3charts/sample-chart1.html",link:function(b,c,d,e){var f={margin:parseInt(d.margin)||20,barHeight:parseInt(d.barHeight)||20,barPadding:parseInt(d.barPadding)||5};b.data=[{name:"Sunil",score:99},{name:"Praveen",score:58},{name:"James",score:80},{name:"Thomas",score:95},{name:"Karry",score:40}];var g=($(c),d3.select(c[0]).select(".chart-container").append("svg").attr("width",500).attr("height",300));b.$watch("data",function(){a(g,b.data,f)},!0)}}}]),angular.module("pvApp.d3charts.services").service("d3LexService",["$q","$http","$timeout",function(a,b,c){function d(a){return JSON.parse(JSON.stringify(a))}function e(b,e){var f=a.defer();return c(function(){e===!0&&(k={});var a=d(b),c={nodes:[],edges:[]};void 0!==a&&(a.forEach(function(a,b){a.type===l?c.nodes.push(a):a.type===m&&c.edges.push(a)}),g(c.nodes),i(c.edges),f.resolve(k))}),f.promise}function f(a){var b;if(void 0!==k&&void 0!==k.nodes&&k.nodes.length&&void 0!==a)for(var c=k.nodes.length,d=0;c>d;d++)if(k.nodes[d].id===a){b=k.nodes[d];break}return b}function g(a){k.nodes=k.nodes||[],void 0!==a&&a.length&&a.forEach(function(a,b){void 0===f(a.id)&&k.nodes.push(a)})}function h(a){var b={};if(void 0!==k&&void 0!==k.nodes&&k.nodes.length)for(var c=k.nodes.length,d=0;c>d&&(k.nodes[d].id===a.inV&&(b.sourceIndex=d),k.nodes[d].id===a.outV&&(b.targetIndex=d),void 0===b.sourceIndex||void 0===b.targetIndex);d++);return b}function i(a){k.edges=k.edges||[],void 0!==a&&a.length&&a.forEach(function(a,b){var c=h(a);void 0!==c&&void 0!==c.sourceIndex&&void 0!==c.targetIndex&&(a.source=c.sourceIndex,a.target=c.targetIndex,k.edges.push(a))})}function j(){return k}var k={},l="vertex",m="edge";return{parseRawToGraph:e,getGraph:j}}]),angular.module("pvApp.d3charts.services").service("d3chartsService",["$q","$http",function(a,b){function c(b,c){var d=a.defer();(void 0===b||isNaN(b))&&d.resolve({data:{nodes:[],links:[]}});var e=b/4,f=[{id:1,name:"country"},{id:1,name:"company"},{id:1,name:"technology"},{id:1,name:"domain"}],g=[];return f.forEach(function(a,b){for(var d=0;e>d;d++){var f={id:880680,label:"person",type:"vertex",category:{id:1,name:"country"},properties:{person_emailId:[{id:"1241x-ivjc-4qt",value:"barbara.clancey@ipgdirect.com"}],person_salary:[{id:"125mt-ivjc-6bp",value:"54000.0"}],person_department:[{id:"1258l-ivjc-f0l",value:"DEVELOPMENT"}],person_age:[{id:"124ud-ivjc-7wl",value:"44"}],person_isInternal:[{id:"124g5-ivjc-9hh",value:"false"}]}};f.id=1+d,f.label=a.name+(d+1),f.category=a,g.push(f),"function"==typeof c&&c((b+1)*(d+1))}}),d.resolve({data:{nodes:g,links:[]}}),d.promise}function d(){var c=a.defer();return b.get(g.graphData).then(function(a){c.resolve(a)},function(){c.resolve({errorMessage:"No Results Found"})}),c.promise}function e(){var c=a.defer();return b.get(g.forceGraphData).then(function(a){f=a.data,c.resolve(a)},function(){c.resolve({errorMessage:"No Results Found"})}),c.promise}var f,g={graphData:"subprojects/data/d3charts/graph-data.json",forceGraphData:"subprojects/data/d3charts/force-graph-data.json",forceGraphData1:"subprojects/data/d3charts/force-graph-data1.json"};return{getGraphData:d,getForceGraphData:e,getLexData:c}}]),angular.module("pvApp.d3charts.services").service("d3graphFactory",["$q","$http",function(a,b){function c(a,b,c){var d={data:[],edges:[],meta:{}};if(void 0===a||isNaN(a))return d;var e=parseInt(a/b.length),f=[];return b.forEach(function(a,b){for(var c=0;e>c;c++){var d=parseInt(b*e+c),g={id:100+d,label:a.label,type:"vertex",properties:{person_name:"NODE-"+d,person_emailId:[{id:"1241x-ivjc-4qt",value:"barbara.clancey@ipgdirect.com"}],person_salary:[{id:"125mt-ivjc-6bp",value:"54000.0"}],person_department:[{id:"1258l-ivjc-f0l",value:"DEVELOPMENT"}],person_age:[{id:"124ud-ivjc-7wl",value:"44"}],person_isInternal:[{id:"124g5-ivjc-9hh",value:"false"}]}};f.push(g)}}),d.edges=g(f,b,c),d.data=f,d}function d(a,b){return a.filter(function(a,c){return a.label===b.label})}function e(a,b,c,e){var f=[],g=d(a,c),h=g.length;e>h&&(e=h);for(var i=1,j=0;j<g.length&&e>=i;j++){var k=g[j],l={id:"126f9-ivjc-2dx-35s"+j,label:"EMAILS_TO",type:"edge",inVLabel:k.label,outVLabel:b.label,inV:b.id,outV:k.id,properties:{Date:"02-13-2001 14:10:00 +0530",ccBcc:"TO",email_messageId:"802872"}};f.push(l),i++}return f}function f(a,b){var c=e(targetVertexNodes,a,categories[i+1],numberOfEdgesToCreate);edges=edges.concat(c)}function g(a,b,c){for(var e=[],g=0;g<b.length-1;g++){var h=d(a,b[g]);h.forEach(f)}return e}return{createVertexData:c}}]),angular.module("pvApp.d3charts.services").service("d3graphService",["$q","$http","$timeout",function(a,b,c){function d(){var c=a.defer();return b.get(m.graphCategories).then(function(a){c.resolve(a)},function(){c.resolve({errorMessage:"No Results Found"})}),c.promise}function e(){var c=a.defer();return void 0!==l?c.resolve({data:l}):b.get(m.graphAllData6Cats).then(function(a){l={nodes:a.data.data,edges:a.data.edges},c.resolve(a)},function(){c.resolve({errorMessage:"No Results Found"})}),c.promise}function f(b){var d=a.defer(),e=l&&l.nodes;return c(function(){d.resolve(e.filter(function(a,c){return a.label===b.label}))},300),d.promise}function g(b){var d=a.defer(),e=l&&l.edges;return c(function(){var a=[];e.filter(function(c,d){if(c.inV===b.id){var e=h(c.outV);void 0!==e&&(a.push(e),a.push(c))}}),d.resolve(a)},300),d.promise}function h(a){for(var b,c=l&&l.nodes,d=c.length,e=0;d>e;e++)if(c[e].id===a){b=c[e];break}return b}function i(){return l}function j(c){var d=a.defer();return b({method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},url:m.LEX_queryUrl,data:{gremlin:c}}).then(function(a){d.resolve(a)},function(){d.resolve({errorMessage:"No Results Found or Some error occured"})}),d.promise}function k(b){var c=a.defer(),d="g.V("+b+").out()",e="g.V("+b+").outE()",f=j(d).then(function(a){return a}),g=j(e).then(function(a){return a});return a.all([f,g]).then(function(a){var b;a&&2===a.length&&(b=a[0],b.data.result.data=b.data.result.data.concat(a[1].data.result.data)),c.resolve(b)}),c.promise}var l,m={graphCategories:"subprojects/data/d3charts/graph-categories.json",graphAllData:"subprojects/data/d3charts/graph-all-data.json",graphAllData6Cats:"subprojects/data/d3charts/graph-all-data-6cat.json",lexGeneratedData:"subprojects/data/d3charts/lex-generated-data.json",LEX_queryUrl:"http://10.203.100.224:8182/"};return e(),{getGraphCategories:d,getAllNodeVerticesAndEdgesData:e,getNodesByCategory:f,getAllData:i,getChildrenOfNode:g,lexRunQuery:j,lexNodesAndEdgesByNodeId:k}}]),angular.module("pvApp.sqlTool.controllers").controller("sqlToolController",["$scope","$templateCache","sqlToolService",function(a,b,c){c.getDatabases().then(function(b){a.currentDatabases=b.data})}]),angular.module("pvApp.sqlTool.controllers").controller("tablesController",["$scope",function(a){a.currentTables=[{id:"1",name:"courses",columns:[{id:"1",name:"id",description:"Course Unique ID",dataType:"numeric",primaryKey:!0},{id:"2",name:"name",description:"Course Name",dataType:"varChar",primaryKey:!1}]},{id:"2",name:"modules",columns:[{id:"1",name:"id",description:"Course Unique ID",dataType:"numeric",primaryKey:!0},{id:"2",name:"name",description:"Course Name",dataType:"varChar",primaryKey:!1}]},{id:"3",name:"programs",columns:[{id:"1",name:"id",description:"Course Unique ID",dataType:"numeric",primaryKey:!0},{id:"2",name:"name",description:"Course Name",dataType:"varChar",primaryKey:!1}]},{id:"1",name:"courses",columns:[{id:"1",name:"id",description:"Course Unique ID",dataType:"numeric",primaryKey:!0},{id:"2",name:"name",description:"Course Name",dataType:"varChar",primaryKey:!1}]},{id:"2",name:"modules",columns:[{id:"1",name:"id",description:"Course Unique ID",dataType:"numeric",primaryKey:!0},{id:"2",name:"name",description:"Course Name",dataType:"varChar",primaryKey:!1}]},{id:"3",name:"programs",columns:[{id:"1",name:"id",description:"Course Unique ID",dataType:"numeric",primaryKey:!0},{id:"2",name:"name",description:"Course Name",dataType:"varChar",primaryKey:!1}]}]}]),angular.module("pvApp.sqlTool.directives").directive("sqlTable",[function(){return{restrict:"AE",templateUrl:"subprojects/pages/sqlTool/sql-table.html",link:function(a,b,c,d){}}}]),angular.module("pvApp.sqlTool.directives").directive("tablesList",["$timeout",function(a){return{restrict:"AE",templateUrl:"subprojects/pages/sqlTool/sql-table.html",link:function(a,b,c,d){var e="<b>ME</b>";e=encodeURIComponent(e),$("#mailtolink").attr("href","mailto:me@me.com?subject=Me&body="+e),a.$watch("currentTables",function(a,c,d){void 0!==a&&null!==a&&$(b).find(".tables-list").tinyscrollbar({trackSize:100,thumbSize:5})})}}}]),angular.module("pvApp.sqlTool.services").service("sqlToolService",["$http","$q",function(a,b){function c(){var c=b.defer();return a.get(d.databasesUrl).then(function(a){c.resolve(a)},function(){c.resolve({errorMessage:"No Results Found"})}),c.promise}var d={databasesUrl:"subprojects/data/sqlTool/databases.json",tablesUrl:"subprojects/data/sqlTool/tables.json"};return{getDatabases:c}}]);